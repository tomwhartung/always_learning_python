
# 4-polls_to_emails project

Experimenting with parts of djangoproject.com's polls app, attempting to apply the steps to a simple app that stores emails.

## References:

Most of this is based on information on this page:

(1) https://docs.djangoproject.com/en/1.10/intro/tutorial01/

If I need a second opinion, I will probably go to the O'Reilly book, Lightweight Django:

(2) http://shop.oreilly.com/product/0636920032502.do

However, I am learning that the djangoproject site seems to really be the best source of information.

## Goal:

Following the steps in the tutorial for the polls app, we want to try making an app that stores emails in a database.

1. Initially we want to gather the email addresses of people who visit a site and are interested in more information.

2. There will not be any sort of online access to these; if and when we use them it will be from behind a firewall.

3. If and when we do use them, we will want to provide an interface for unsubscribing from the list.

## Requirements:

For this application, we will use SQLite.

Based on what I read in the book today, django provides default forms for entering data.

It is perfectly acceptable to use these default forms rather than create our own.

### Values to Store

We need only one table to store the following information:

* Visitor's Name - optional string; prompt for both first and last name
* Visitor's Email - required string; plan to validate in both front and back end (at least require an "@" and a ".")
* Site (List Name) - required 2-character site abbreviation: 'g' 'jm' 'sm' 'th' 'tw'; hidden value in email submission form

## Initial setup

### The `documents` Directory

Decided to create this and put a simple "Hello world" index.html file in it.

This may come in handy some day - possibly for sharing static content between apps - especially if I already have it.

### The `Site` Directory

This directory contains the code we are writing, based on the polls app but modified for our simple email gathering app.

## Tutorial (1) - Project and App Setup

Taking note of the commands run to set this up, so we can do it more quickly when it's time to do it "for realsies."

### Step (1.1) Starting with startproject:

Note that we need to run the `python3` command to run the server, so that it can access django.

```
django-admin startproject Site
git add Site
git commit -m 'Files generated by "django-admin startproject Site" command.'
git push origin master
cd Site
python3 manage.py runserver
```

Accessing the following URL should display the "It worked!" message.

* http://localhost:8000/

### Step (1.2) Running startapp:

From Part 1 of the tutorial at djangoproject.com:

* "A project is a collection of configuration and apps for a particular website. A project can contain multiple apps. An app can be in multiple projects."

```
django-admin startapp get_emails
git add get_emails
git commit -m 'Files generated by "django-admin startapp get_emails" command.'
git push origin master
```

### Step (1.3) creating a view:

Note that we need to run the `python3` command to run the server, so that it can access django.

```
cd get_emails
vi views.py   ## Updated as described in the main reference (1)
vi urls.py    ## Updated as described in the main reference (1)
cd ../Site
vi urls.py    ## Updated as described in the main reference (1)
python3 manage.py runserver
```

Accessing the following URL displays the "Hi from the get_emails index." message.

* http://localhost:8000/get_emails/

(Commit changes to github.)

## Tutorial (2) - Database Setup

As mentioned in the Requirements section, we are using SQLite and creating only one table, which in turn has only a few columns.

Reference: https://docs.djangoproject.com/en/1.10/intro/tutorial02/

> SQLite is included in Python, so you wonâ€™t need to install anything else to support your database.

### Step (2.1) Edit the Settings

Following the reference, edit the values for the TIME_ZONE and INSTALLED_APPS parameters in `settings.py` and run `migrate` .

```
vi settings.py              ## The list of default apps looks reasonable to me (changed the TIME_ZONE only)
python3 manage.py migrate   ## Note: use python3!!
git add settings.py
git commit -m 'Updated the TIME_ZONE in settings.py (the list of INSTALLED_APPS looks reasonable enough to me).'
git add db.sqlite3
git commit -m 'Version of db.sqlite3 updated by running migrate.'
```

We can now run the `python3 manage.py runserver` command without it complaining about needing to run the migrations.

